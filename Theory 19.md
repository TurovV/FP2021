# Теория. Билет 19 "Обобщения алгоритма Хиндли-Милнера. let-полиморфизм и его ограничения" (Денис Шестаков)

## Напоминание

У нас есть алгоритм поиска главной пары, который по терму выдает его тип и нужный контекст.

![alt text](https://ie.wampi.ru/2021/12/24/17.5.png)

## Мощь теоремы Хиндли-Милнера

Теорему Хиндли-Милнера можно расширить с обычных типов на конструкторы типов.
Более того, кроме переменных типа можем использовать и константы (*Bool, Char, ...*)

![alt text](https://ie.wampi.ru/2021/12/24/18.4.png)

Решения:

![alt text](https://wampi.ru/image/RaBmkQE)

В третьем примере мы расширяем контекст.

## Проблема и её решение let-полиморфизмом

![alt text](https://ie.wampi.ru/2021/12/24/18.6.png)

Мы получаем какую-то функцию *f*, действующую из *a* в *b*. Запуская алгоритм поиска главной пары
система ограничений говорит нам, что *a* - это *Char*, а потом что *a* - это *Bool*. Получаем ошибку.
Но проблема в том, что мы можем передать какую-то полиморфную функцию, например *Id*.

Такая проблема решается let-полиморфизмом, когда наш редекс сконструирован явно. 

![alt text](https://ie.wampi.ru/2021/12/24/18.7.png)

К сожалению, это тоже работает не всегда. Но все решается расширением.
Для этого нужно явно объявлять функцию полиморфной через *forall*.

![alt text](https://ie.wampi.ru/2021/12/24/18.8.png)